
using System.IO;
using System.Text;

namespace KPIT_K_Foundation
{
  internal class WinFormApplicationDesigner
  {
    private string _fullFileNamePath;
    private string _winformAppName;

    private WinFormApplicationDesigner()
    {
    }

    internal WinFormApplicationDesigner(string fullFileNamePath, string winformAppName)
    {
      this._fullFileNamePath = fullFileNamePath;
      this._winformAppName = winformAppName;
      this.Generate();
    }

    private void Generate()
    {
      using (StreamWriter streamWriter = new StreamWriter(this._fullFileNamePath))
      {
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.AppendLine("'------------------------------------------------------------------------------");
        stringBuilder.AppendLine("' <auto-generated>");
        stringBuilder.AppendLine("'     This code was generated by a tool.");
        stringBuilder.AppendLine("'     Runtime Version:4.0.30319.42000");
        stringBuilder.AppendLine("'");
        stringBuilder.AppendLine("'     Changes to this file may cause incorrect behavior and will be lost if");
        stringBuilder.AppendLine("'     the code is regenerated.");
        stringBuilder.AppendLine("' </auto-generated>");
        stringBuilder.AppendLine("'------------------------------------------------------------------------------");
        stringBuilder.AppendLine("");
        stringBuilder.AppendLine("Option Strict On");
        stringBuilder.AppendLine("Option Explicit On");
        stringBuilder.AppendLine("");
        stringBuilder.AppendLine("");
        stringBuilder.AppendLine("Namespace My");
        stringBuilder.AppendLine("    ");
        stringBuilder.AppendLine("    'NOTE: This file is auto-generated; do not modify it directly.  To make changes,");
        stringBuilder.AppendLine("    ' or if you encounter build errors in this file, go to the Project Designer");
        stringBuilder.AppendLine("    ' (go to Project Properties or double-click the My Project node in");
        stringBuilder.AppendLine("    ' Solution Explorer), and make changes on the Application tab.");
        stringBuilder.AppendLine("    '");
        stringBuilder.AppendLine("    Partial Friend Class MyApplication");
        stringBuilder.AppendLine("");
        stringBuilder.AppendLine("        <Global.System.Diagnostics.DebuggerStepThroughAttribute()>  _");
        stringBuilder.AppendLine("        internal Sub New()");
        stringBuilder.AppendLine("            MyBase.New(Global.Microsoft.VisualBasic.ApplicationServices.AuthenticationMode.Windows)");
        stringBuilder.AppendLine("            Me.IsSingleInstance = false");
        stringBuilder.AppendLine("            Me.EnableVisualStyles = true");
        stringBuilder.AppendLine("            Me.SaveMySettingsOnExit = true");
        stringBuilder.AppendLine("            Me.ShutDownStyle = Global.Microsoft.VisualBasic.ApplicationServices.ShutdownMode.AfterMainFormCloses");
        stringBuilder.AppendLine("        End Sub");
        stringBuilder.AppendLine("");
        stringBuilder.AppendLine("        <Global.System.Diagnostics.DebuggerStepThroughAttribute()>  _");
        stringBuilder.AppendLine("        Protected Overrides Sub OnCreateMainForm()");
        stringBuilder.AppendLine("            Me.MainForm = Global." + this._winformAppName + ".DefaultWinForm");
        stringBuilder.AppendLine("        End Sub");
        stringBuilder.AppendLine("    End Class");
        stringBuilder.AppendLine("End Namespace");
        streamWriter.Write(stringBuilder.ToString());
      }
    }
  }
}
